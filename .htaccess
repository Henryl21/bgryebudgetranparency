<IfModule mod_rewrite.c>
    RewriteEngine On

    # Force HTTPS (only if not already HTTPS)
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

    # Route all requests to public/ (Laravel front controller)
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>

# Block common attack patterns in query strings
<IfModule mod_rewrite.c>
    RewriteCond %{QUERY_STRING} union [NC,OR]
    RewriteCond %{QUERY_STRING} select [NC,OR]
    RewriteCond %{QUERY_STRING} sleep [NC]
    RewriteRule .* - [F,L]
</IfModule>

# Disable TRACE method (XSS protection)
TraceEnable off

# Deny access to sensitive files
<FilesMatch "\.(env|config|ini|log|git|sql|sh|bash)$">
    Require all denied
</FilesMatch>
